#!/bin/sh
# Pre-commit hook for PCMigrationTool
# Runs the PowerShell validation script using the appropriate PowerShell executable

# Try to find PowerShell (pwsh, powershell.exe, or powershell)
if command -v pwsh >/dev/null 2>&1; then
    PWSH_CMD="pwsh"
elif command -v powershell.exe >/dev/null 2>&1; then
    PWSH_CMD="powershell.exe"
elif command -v powershell >/dev/null 2>&1; then
    PWSH_CMD="powershell"
else
    echo "Error: PowerShell not found. Please install PowerShell."
    exit 1
fi

# Get the directory where this hook script is located
HOOK_DIR="$(cd "$(dirname "$0")" && pwd)"
SCRIPT_PATH="$HOOK_DIR/pre-commit.ps1"

# Run the PowerShell pre-commit script
exec "$PWSH_CMD" -NoProfile -ExecutionPolicy Bypass -File "$SCRIPT_PATH"
